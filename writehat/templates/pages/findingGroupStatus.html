{% extends 'layouts/base.html' %}

{% block title %}{{ fgroup.name }} Status{% endblock %}

{% block headerLeft %}
    {% include 'snippets/textButton.html' with name='Back' id='backButton' type='chevron-left' class='btn-secondary' %}
    {{ engagement.name }}: {{ fgroup.name }} 
{% endblock %}

{% block fullPane %}

<div class="{{ fgroup.scoringType|lower }} status-container container-fluid px-3 py-2 bg-light border border-info rounded">
    <table class="writehat-table container-fluid table-light table-striped table-hover overflow-auto">
      <thead>
        <tr>
          <th class='cvss dread proactive findingName'><strong>Finding Name</strong></th>
          <th class='cvss dread proactive findingAttr'><div>Description</div></th>
          <th class='cvss dread proactive findingAttr'><div>Affected Resources</div></th>
          <th class='dread findingAttr'><div>Impact</div></th>
          <th class='cvss dread proactive findingAttr'><div>Background</div></th>
          <th class='cvss findingAttr'><div>Proof of Concept</div></th>
          <th class='cvss findingAttr'><div>Tools Used</div></th>
          <th class='cvss dread findingAttr'><div>Remediation</div></th>
          <th class='cvss dread proactive findingAttr'><div>References</div></th>
          <th class='cvss findingAttr'><div>Attack Vector</div></th>
          <th class='cvss findingAttr'><div>Attack Complexity</div></th>
          <th class='cvss findingAttr'><div>Privileges Required</div></th>
          <th class='cvss findingAttr'><div>User Interaction</div></th>
          <th class='cvss findingAttr'><div>Scope</div></th>
          <th class='cvss findingAttr'><div>Confidentiality</div></th>
          <th class='cvss findingAttr'><div>Integrity</div></th>
          <th class='cvss findingAttr'><div>Availability</div></th>
          <th class='dread findingAttr'><div>Damage</div></th>
          <th class='dread findingAttr'><div>Damage Detail</div></th>
          <th class='dread findingAttr'><div>Reproducibility</div></th>
          <th class='dread findingAttr'><div>Reproducibility Detail</div></th>
          <th class='dread findingAttr'><div>Exploitability</div></th>
          <th class='dread findingAttr'><div>Exploitability Detail</div></th>
          <th class='dread findingAttr'><div>Affected Users</div></th>
          <th class='dread findingAttr'><div>Affected Users Detail</div></th>
          <th class='dread findingAttr'><div>Discoverability</div></th>
          <th class='dread findingAttr'><div>Discoverability Detail</div></th>
        </tr>
      </thead>
      <tbody class="text-nowrap">
        {% for finding in fgroup.findings %}
          <tr>
              <td class='findingName'>
                  <a href="/engagements/fgroup/finding/edit/{{ finding.id}}">
                      {{ finding.name }}
                  </a>
              </td>
              <td class='cvss dread proactive findingAttr'>
                  {% if "description" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.description %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss dread proactive findingAttr'>
                  {% if "affectedResources" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.affectedResources %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if "impact" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.impact %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss dread proactive findingAttr'>
                  {% if "background" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.background %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if "proofOfConcept" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.proofOfConcept %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if "toolsUsed" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.toolsUsed %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss dread findingAttr'>
                  {% if "remediation" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.remediation %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss dread proactive findingAttr'>
                  {% if "references" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.references %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssAV %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssAC %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssPR %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssUI %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssS %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssC %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssI %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='cvss findingAttr'>
                  {% if finding.cvss.dict.cvssA %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if finding.dread.dict.dreadDamage %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if "descDamage" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.descDamage %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if finding.dread.dict.dreadReproducibility %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if "descReproducibility" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.descReproducibility %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if finding.dread.dict.dreadExploitability %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if "descExploitability" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.descExploitability %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if finding.dread.dict.dreadAffectedUsers %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if "descAffectedUsers" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.descAffectedUsers %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if finding.dread.dict.dreadDiscoverability %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
              <td class='dread findingAttr'>
                  {% if "descDiscoverability" in finding.todoItems %}
                      <i class="text-warning fa fa-exclamation-circle"></i>
                  {% elif finding.descDiscoverability %}
                      <i class="text-muted fa fa-check"></i>
                  {% else %}
                      <i class="text-danger fas fa-md fa-times-circle"></i>
                  {% endif %}
              </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

{% endblock %}

{% block footer %}
    <span id="engagement-info" engagement-id="{{ engagement.id }}" style="display: none;"></span>
    <script src="/static/js/findingEdit.js"></script>
    <link rel="stylesheet" href="/static/css/findingGroupStatus.css" />
{% endblock %}
